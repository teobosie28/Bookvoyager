{% extends 'library/base.html' %}
{% block content %}
<div class="account-container">
    <h2>My Account</h2>
    <div class="profile-section">
        <img src="{{ user.profile.profile_pic }}" alt="Profile Picture" class="profile-pic" />
        <h3>{{ user.username }}</h3>
        <p>{{ user.profile.bio }}</p>
    </div>
    <div class="favorites-section">
        <h3>Favorites</h3>
        <div class="floating-books-list">
            {% for book in user.profile.favorites.all %}
            <a href="{% url 'book_detail' book.id %}" class="floating-book-cover-link">
                <img src="{{ book.cover_url }}" alt="{{ book.title }} cover" class="floating-book-cover" />
            </a>
            {% empty %}
            <span style="color:#bdbdbd;">No favorites yet.</span>
            {% endfor %}
        </div>
    </div>
    <div class="next-reading-section">
        <h3>Next Reading List</h3>
        <ul class="next-reading-list">
            {% for book in user.profile.next_reading.all %}
            <li>
                <a href="{% url 'book_detail' book.id %}" class="next-reading-link">{{ book.title }}</a>
                <input type="checkbox" class="next-reading-read-checkbox" data-book-id="{{ book.id }}" title="Mark as read" />
            </li>
            {% empty %}
            <li style="color:#bdbdbd;">No books in your next reading list.</li>
            {% endfor %}
        </ul>
    </div>
    <div class="my-reviews-section">
        <h3>My Reviews</h3>
        <ul>
            {% for review in user.reviews.all %}
            <li>{{ review.book.title }} - ‚≠ê {{ review.rating }}<br>{{ review.review_text }}</li>
            {% endfor %}
        </ul>
    </div>
    {% if all_users %}
    <div class="admin-users-section">
        <h3>All Users (Admin Panel)</h3>
        <ul class="admin-users-list">
            {% for u in all_users %}
            <li>
                {{ u.username }} ({{ u.email }})
                {% if user.id != u.id %}
                <form method="post" action="{% url 'delete_user' u.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="delete-user-btn" onclick="return confirm('Are you sure you want to delete this user?');">Delete</button>
                </form>
                {% endif %}
            </li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}
    <div class="account-auth-buttons">
        {% if user.is_authenticated %}
            <a href="/logout/" class="auth-btn">Logout</a>
        {% else %}
            <div class="login-register-block">
                <span class="become-bookaholic">Become a bookaholic!</span><br>
                <a href="/login/" class="auth-btn">Login</a>
                <span class="register-link"> or <a href="/register/">register</a></span>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %} 